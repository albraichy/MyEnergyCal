<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>مُقدِّر السعرات الأساسية</title>
  <style>
    :root{
      --bg:#0b0f14;
      --grad:#121826;
      --card:#121926;
      --text:#e6eef8;
      --muted:#94a3b8;
      --accent:#7dd3fc;
      --shadow:0 6px 22px rgba(0,0,0,.35);
      --radius:14px;
    }
    *{box-sizing:border-box}
    html{height:100%;background:var(--bg)}
    body{
      min-height:100dvh;
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background:linear-gradient(180deg,var(--bg) 0%, var(--grad) 100%);
      padding-top: calc(112px + env(safe-area-inset-top, 0px)); /* space for fixed header */
      padding-bottom: calc(32px + env(safe-area-inset-bottom, 0px));
      display:flex;flex-direction:column;
    }
    /* Fixed top header */
    .topbar{
      position:fixed;inset:0 0 auto 0;height:112px;
      background:rgba(18,25,38,.9);backdrop-filter:saturate(140%) blur(6px);
      display:flex;align-items:center;justify-content:center;
      border-bottom:1px solid #1f2a3c;z-index:50;padding:6px 12px 10px;
    }
    .top-inner{width:100%;max-width:860px;display:grid;justify-items:center;gap:8px}
    .title{margin:0;font-size:20px;letter-spacing:.2px;text-align:center}
    .lang{display:flex;gap:8px;align-items:center;direction:ltr;justify-content:center}
    .lang button{
      border:1px solid #2a3a52;background:#0f172a;color:var(--text);
      padding:6px 10px;border-radius:10px;cursor:pointer;font-weight:700;min-width:44px;
    }
    .lang button.active{background:var(--accent);color:#001018;border-color:transparent}
    /* Layout */
    .wrap{width:100%;max-width:860px;margin:0 auto;display:grid;gap:16px;padding:0 12px;flex:1}
    .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px}
    .grid{display:grid;gap:12px}
    .grid.cols{grid-template-columns:repeat(3,minmax(0,1fr))}
    .field{display:flex;flex-direction:column;gap:6px;align-items:center}
    label{font-size:13px;color:var(--muted)}
    input[type="number"]{
      width:100%;max-width:220px;text-align:center;
      border:1px solid #1f2937;background:#0f172a;color:var(--text);
      padding:12px 10px;border-radius:10px;font-size:15px;outline:none;
    }
    input[type="number"]::placeholder{color:#64748b}
    .gender{display:flex;gap:18px;justify-content:center}
    .gender label{display:flex;gap:8px;align-items:center;color:var(--text);font-size:14px}
    .row{display:flex;gap:12px;justify-content:center;margin-top:4px}
    .btn{
      appearance:none;border:0;border-radius:12px;background:var(--accent);
      color:#001018;font-weight:800;padding:12px 18px;cursor:pointer;font-size:15px;
      box-shadow:0 8px 22px rgba(125,211,252,.25);min-width:120px;
    }
    .btn.secondary{background:#0f172a;color:var(--text);border:1px solid #28364d;box-shadow:none}
    /* Result card small */
    .result{display:grid;gap:10px;justify-items:center;text-align:center}
    .rbox{border:1px solid #27364f;background:#0c1424;padding:10px 12px;border-radius:12px;width:min(380px,100%)}
    .rtitle{margin:0 0 4px 0;font-size:14px;color:var(--text);opacity:.9}
    .rvalue{font-size:22px;font-weight:800;letter-spacing:.3px}
    footer{color:var(--muted);font-size:12px;text-align:center;margin-top:auto;padding:8px 12px 0}
    .small-note{color:var(--muted);font-size:12px;margin-bottom:4px}
    @media (max-width:600px){ .grid.cols{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <div class="topbar">
    <div class="top-inner">
      <h1 class="title" id="title">مُقدِّر السعرات الأساسية</h1>
      <div class="lang" aria-label="Language">
        <button id="btn-en" type="button">E</button>
        <button id="btn-ar" class="active" type="button">ع</button>
      </div>
    </div>
  </div>

  <main class="wrap">
    <section class="card">
      <div class="grid">
        <div class="field">
          <label id="lab-gender">الجنس</label>
          <div class="gender" role="radiogroup" aria-label="Gender">
            <label><input type="radio" name="gender" value="male" checked> <span id="lab-male">ذكر</span></label>
            <label><input type="radio" name="gender" value="female"> <span id="lab-female">أنثى</span></label>
          </div>
        </div>
        <div class="grid cols">
          <div class="field">
            <label for="age" id="lab-age">العمر (سنة)</label>
            <input id="age" type="number" inputmode="numeric" min="10" max="100" step="1" placeholder="31">
          </div>
          <div class="field">
            <label for="weight" id="lab-weight">الوزن (كجم)</label>
            <input id="weight" type="number" inputmode="decimal" min="30" max="250" step="0.1" placeholder="90">
          </div>
          <div class="field">
            <label for="height" id="lab-height">الطول (سم)</label>
            <input id="height" type="number" inputmode="decimal" min="120" max="230" step="0.1" placeholder="172">
          </div>
        </div>
        <div class="row">
          <button id="calc" class="btn" type="button">احسب</button>
          <button id="reset" class="btn secondary" type="button">إعادة تعيين</button>
        </div>
      </div>
    </section>

    <section class="card result" aria-live="polite">
      <div class="rbox">
        <h3 class="rtitle" id="avg-label">سعرات المحافظة اليومية</h3>
        <div class="rvalue" id="avg">—</div>
      </div>
    </section>
  </main>

  <footer>
    <div class="small-note" id="msg-line">تقدير مبني على ثلاث طرق موثوقة لتتبع السعرات</div>
    <div id="copyright">© 2025 — جميع الحقوق محفوظة.</div>
  </footer>

<script>
(function(){
  const $ = (id)=>document.getElementById(id);
  const roundTo50 = (x)=> Math.round(x/50)*50;

  const i18n = {
    ar: {
      dir:"rtl", title:"مُقدِّر السعرات الأساسية",
      gender:"الجنس", male:"ذكر", female:"أنثى",
      age:"العمر (سنة)", weight:"الوزن (كجم)", height:"الطول (سم)",
      calc:"احسب", reset:"إعادة تعيين",
      avgLabel:"سعرات المحافظة اليومية",
      msg:"تقدير مبني على ثلاث طرق موثوقة لتتبع السعرات",
      rights:"© 2025 — جميع الحقوق محفوظة."
    },
    en: {
      dir:"ltr", title:"Calorie baseline estimator",
      gender:"Gender", male:"Male", female:"Female",
      age:"Age (years)", weight:"Weight (kg)", height:"Height (cm)",
      calc:"Calculate", reset:"Reset",
      avgLabel:"Daily maintenance calories",
      msg:"Estimate based on three validated methods for calorie tracking",
      rights:"© 2025 — All rights reserved."
    }
  };

  function setLang(lang){
    const t = i18n[lang];
    document.documentElement.lang = lang;
    document.documentElement.dir  = t.dir;
    $('title').textContent = t.title;
    $('lab-gender').textContent = t.gender;
    $('lab-male').textContent = t.male;
    $('lab-female').textContent = t.female;
    $('lab-age').textContent = t.age;
    $('lab-weight').textContent = t.weight;
    $('lab-height').textContent = t.height;
    $('calc').textContent = t.calc;
    $('reset').textContent = t.reset;
    $('avg-label').textContent = t.avgLabel;
    $('msg-line').textContent = t.msg;
    $('copyright').textContent = t.rights;
    document.getElementById('btn-ar').classList.toggle('active', lang==='ar');
    document.getElementById('btn-en').classList.toggle('active', lang==='en');
  }

  function compute(){
    const gender = document.querySelector('input[name="gender"]:checked')?.value || 'male';
    const age = parseFloat($('age').value);
    const weight = parseFloat($('weight').value);
    const height = parseFloat($('height').value);
    if(!Number.isFinite(age) || !Number.isFinite(weight) || !Number.isFinite(height)){
      $('avg').textContent = '—'; return;
    }
    // Mifflin–St Jeor × 1.5
    const mifflinBMR = (10*weight) + (6.25*height) - (5*age) + (gender === 'male' ? 5 : -161);
    const mifflinTDEE = mifflinBMR * 1.5;
    // EER (IOM 2002), PA = 1.0
    const hM = height/100;
    const eer = (gender === 'male')
      ? (662 - (9.53*age) + (15.91*weight) + (539.6*hM))
      : (354 - (6.91*age) + (9.36*weight) + (726*hM));
    // Harris–Benedict (Revised) × 1.375
    const hbBMR = (gender === 'male')
      ? (66.4730 + (13.7516*weight) + (5.0033*height) - (6.7550*age))
      : (655.0955 + (9.5634*weight) + (1.8496*height) - (4.6756*age));
    const hbTDEE = hbBMR * 1.375;
    // Average and round to nearest 50
    const avg = (mifflinTDEE + eer + hbTDEE) / 3;
    $('avg').textContent = Math.round(roundTo50(avg)) + " kcal";
  }

  function resetAll(){
    ['age','weight','height'].forEach(id=>{$(id).value='';});
    $('avg').textContent='—';
  }

  document.getElementById('calc').addEventListener('click', compute);
  document.getElementById('reset').addEventListener('click', resetAll);
  ['age','weight','height'].forEach(id=>{
    document.getElementById(id).addEventListener('keydown', (e)=>{ if(e.key==='Enter') compute(); });
  });
  document.getElementById('btn-en').addEventListener('click', ()=>setLang('en'));
  document.getElementById('btn-ar').addEventListener('click', ()=>setLang('ar'));

  setLang('ar'); // default Arabic
})();
</script>
</body>
</html>
